<!DOCTYPE html>
<html lang="es" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informacion Nacional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        
        .contact-link {
            color: #d9463f;
            text-decoration: underline;
            font-weight: 500;
        }
        .dark .contact-link { color: #f87171; }
        .contact-link:hover { color: #b91c1c; }
        .dark .contact-link:hover { color: #ef4444; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.75; }
        }
        .status-pulse {
            animation: pulse 2.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        details[open] > summary {
            border-bottom: 1px solid #e5e7eb;
        }
        .dark details[open] > summary {
            border-bottom-color: #374151;
        }
        .chevron-icon {
            transition: transform 0.3s ease-in-out;
        }
        details[open] .chevron-icon {
            transform: rotate(90deg);
        }
        /* Estilo para el enlace del men√∫ activo */
        .menu-link-active {
            background-color: #fef2f2; /* red-100 */
            border-left: 4px solid #dc2626; /* red-600 */
            font-weight: 600;
        }
        .dark .menu-link-active {
            background-color: rgba(153, 27, 27, 0.3); /* dark:bg-red-900/30 */
        }
    </style>
</head>
<body class="antialiased bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200">

    <button id="menu-toggle" class="md:hidden fixed top-4 left-4 z-30 p-2 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-full shadow-lg">
        <svg id="menu-open-icon" class="h-6 w-6 text-gray-800 dark:text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/></svg>
        <svg id="menu-close-icon" class="h-6 w-6 text-gray-800 dark:text-gray-200 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
    </button>

    <div class="flex flex-col md:flex-row min-h-screen">
        <aside id="sidebar" class="w-64 bg-white dark:bg-gray-800 shadow-lg flex-shrink-0 transform -translate-x-full md:translate-x-0 fixed md:relative h-full z-20 transition-transform duration-300 ease-in-out">
            <div class="p-6 text-center border-b border-gray-200 dark:border-gray-700 bg-red-600">
                <h1 class="text-2xl font-bold text-white">DIA</h1>
            </div>
            <div class="p-4 flex flex-col justify-between" style="height: calc(100% - 81px);">
                <nav id="main-menu" class="space-y-1">
                    <h2 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider px-4 mb-2">Men√∫</h2>
                    
                    <a href="#" data-panel="panel-consulta" class="menu-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 rounded-lg">
                        <svg class="h-5 w-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                        Consulta Principal
                    </a>
                    
                    <details class="group">
                        <summary class="flex items-center justify-between px-4 py-3 font-semibold text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 cursor-pointer">
                            <div class="flex items-center">
                                <svg class="h-5 w-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" /></svg>
                                <span>Herramientas</span>
                            </div>
                            <svg class="chevron-icon h-5 w-5 transform transition-transform duration-300 group-open:rotate-90" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </summary>
                        <div class="pl-8 pt-1 pb-2 space-y-1">
                            <a href="https://drive.google.com/file/d/1JWhcsoPUiOIcyr4mJZb9pWRHUZYDoUp7/view" target="_blank" rel="noopener noreferrer" class="flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Decomisos</a>
                            <a href="https://drive.google.com/file/d/1iHIdN_UYtQxc04wU-EQVa-EolY4f29Ky/view" target="_blank" rel="noopener noreferrer" class="flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Servicio a tienda</a>
                            <a href="https://drive.google.com/drive/u/0/folders/1-vtsX9_v11x6wZT-X3TZon6Y2DeVZ3nw" target="_blank" rel="noopener noreferrer" class="flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Heladeras comerciales</a>
                            <a href="https://drive.google.com/drive/u/0/folders/1unmBiVA6RVgg7prlWwYc4i4Y_XnfYChQ" target="_blank" rel="noopener noreferrer" class="flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Carpeta digital</a>
                            <a href="https://lookerstudio.google.com/reporting/89136f12-7eb0-45d2-a752-40108bcb3150/page/p_npwwtrfkrd" target="_blank" rel="noopener noreferrer" class="flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Reporte Contact</a>
                        </div>
                    </details>
                    
                    <details class="group" open>
                        <summary class="flex items-center justify-between px-4 py-3 font-semibold text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 cursor-pointer">
                            <div class="flex items-center">
                                <svg class="h-5 w-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z" />
                                </svg>
                                <span>Otros</span>
                            </div>
                            <svg class="chevron-icon h-5 w-5 transform transition-transform duration-300 group-open:rotate-90" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                        </summary>
                        <div class="pl-8 pt-1 pb-2 space-y-1">
                            <a href="#" data-panel="panel-prov-zona" class="menu-link flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Proveedores Zona</a>
                            <a href="#" data-panel="panel-prov-contacto" class="menu-link flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Proveedores Contacto</a>
                            <a href="#" data-panel="panel-horario-contact" class="menu-link flex items-center px-4 py-2 text-sm text-gray-600 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Horario Contact</a>
                        </div>
                    </details>
                </nav>
            </div>
        </aside>

        <div class="flex-1 p-4 sm:p-6 md:p-10 overflow-y-auto">
            <main>
                <div id="panel-consulta" class="content-panel">
                    <header class="text-center mb-12 pt-16 md:pt-0">
                         <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2">Informacion Nacional</h1>
                         <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Ingresa el n√∫mero de tienda o palabra clave para encontrar la informaci√≥n.</p>
                    </header>
                    
                    <div class="mb-8 max-w-2xl mx-auto">
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-gray-400 dark:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                            </div>
                            <input type="text" id="search-input" placeholder="Buscar por Tienda, Direcci√≥n, Proveedor..." class="w-full pl-11 pr-10 py-3 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-red-500 focus:border-red-500 focus:shadow-lg transition-shadow" disabled>
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <button id="clear-button" class="hidden p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600">
                                    <svg class="h-5 w-5 text-gray-500 dark:text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div id="results-container" class="space-y-4">
                        <p id="initial-message" class="text-center text-gray-500 dark:text-gray-400">Cargando datos desde Google Sheets...</p>
                        <p id="no-results-message" class="text-center text-gray-500 dark:text-gray-400 hidden">No se encontraron resultados.</p>
                    </div>
                </div>

                <div id="panel-prov-zona" class="content-panel hidden">
                    <header class="text-center mb-12 pt-16 md:pt-0">
                         <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2">Proveedores por Zona</h1>
                         <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Aqu√≠ puedes agregar la informaci√≥n o la tabla correspondiente a los proveedores por zona.</p>
                    </header>
                    </div>

                <div id="panel-prov-contacto" class="content-panel hidden">
                     <header class="text-center mb-12 pt-16 md:pt-0">
                         <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2">Contacto de Proveedores</h1>
                         <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Aqu√≠ puedes agregar la informaci√≥n de contacto de los proveedores.</p>
                    </header>
                    </div>

                <div id="panel-horario-contact" class="content-panel hidden">
                    <header class="text-center mb-12 pt-16 md:pt-0">
                         <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2">Horarios de Contacto</h1>
                         <p class="text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">Aqu√≠ puedes agregar la informaci√≥n sobre los horarios de contacto.</p>
                    </header>
                    </div>
                </main>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('menu-toggle');
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('-translate-x-full');
            document.getElementById('menu-open-icon').classList.toggle('hidden');
            document.getElementById('menu-close-icon').classList.toggle('hidden');
        });

        const themeMatcher = window.matchMedia('(prefers-color-scheme: dark)');
        const applyTheme = (isDark) => document.documentElement.classList.toggle('dark', isDark);
        applyTheme(themeMatcher.matches);
        themeMatcher.addEventListener('change', (e) => applyTheme(e.matches));

        const searchInput = document.getElementById('search-input');
        const clearButton = document.getElementById('clear-button');
        
        searchInput.addEventListener('input', () => {
            clearButton.classList.toggle('hidden', searchInput.value.length === 0);
        });

        clearButton.addEventListener('click', () => {
            searchInput.value = '';
            searchInput.dispatchEvent(new Event('input', { bubbles: true }));
            searchInput.focus();
        });

        // --- INICIO: L√≥gica para manejar los paneles de contenido ---
        const menuLinks = document.querySelectorAll('.menu-link');
        const contentPanels = document.querySelectorAll('.content-panel');

        const setActiveLink = (link) => {
            // Quita la clase activa de todos los enlaces
            menuLinks.forEach(l => l.classList.remove('menu-link-active'));
            // Agrega la clase activa al enlace presionado
            link.classList.add('menu-link-active');
        };

        const showPanel = (panelId) => {
            // Oculta todos los paneles
            contentPanels.forEach(p => p.classList.add('hidden'));
            // Muestra solo el panel que corresponde
            const panelToShow = document.getElementById(panelId);
            if(panelToShow) {
                panelToShow.classList.remove('hidden');
            }
        };

        menuLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault(); // Evita que la p√°gina se recargue
                const panelId = link.getAttribute('data-panel');
                
                // Muestra el panel y pone el link como activo
                showPanel(panelId);
                setActiveLink(link);
            });
        });

        // Inicia con la "Consulta Principal" como activa
        const initialLink = document.querySelector('[data-panel="panel-consulta"]');
        setActiveLink(initialLink);
        showPanel('panel-consulta');
        // --- FIN: L√≥gica para manejar los paneles de contenido ---

        const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbza0bp58mq-UfOa5rJ_pNDMMpw2rulYKiadHv9offbcruu6rpfIAxVtHkiYGUQamDNyww/exec';
        const resultsContainer = document.getElementById('results-container');
        const initialMessage = document.getElementById('initial-message');
        const noResultsMessage = document.getElementById('no-results-message');

        fetch(GOOGLE_SHEET_URL)
            .then(response => {
                if (!response.ok) throw new Error(`Error de red: ${response.statusText}`);
                return response.json();
            })
            .then(data => {
                initialMessage.textContent = 'Ingresa un t√©rmino de b√∫squeda para ver los resultados.';
                searchInput.disabled = false;
                setupSearch(data);
            })
            .catch(error => {
                console.error('Error al cargar los datos de Google Sheets:', error);
                resultsContainer.innerHTML = `<p class="text-center text-red-500 font-semibold">Error: No se pudieron cargar los datos. Revisa la URL o la configuraci√≥n de permisos del script.</p>`;
            });
        
        function setupSearch(sheetData) {
            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.trim().toLowerCase();
                if (searchTerm.length === 0) {
                    resultsContainer.innerHTML = '';
                    initialMessage.classList.remove('hidden');
                    noResultsMessage.classList.add('hidden');
                    return;
                }
                const filteredData = sheetData.filter(row => {
                    const isNumericSearch = /^\d+$/.test(searchTerm);
                    if (isNumericSearch) {
                        return String(row.Tienda).toLowerCase() === searchTerm;
                    } else {
                        return Object.values(row).some(value =>
                            String(value).toLowerCase().includes(searchTerm)
                        );
                    }
                });
                displayResults(filteredData);
            });
        }

        function displayResults(data) {
            resultsContainer.innerHTML = '';
            initialMessage.classList.add('hidden');
            noResultsMessage.classList.add('hidden');

            if (data.length === 0) {
                noResultsMessage.classList.remove('hidden');
                return;
            }

            data.forEach(row => {
                const card = document.createElement('div');
                card.className = 'result-card bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-200 dark:border-gray-700 overflow-hidden';
                
                const keysMostradas = ['Tienda', 'Direccion', 'Localidad', 'Provincia','Gerente de ventas', 'Gerente de ventas contacto','Gerente Regional', 'Gerente regional contacto','Franquiciado', 'Franquiciado contacto','Gesti√≥n', 'Zona', 'Formato', 'Tecnicos internos','Zona tecnicos', 'EMail', 'HORARIO LUNES A SABADO','HORARIO DOMINGO', 'Sindicato','SUPERVISOR PP', 'SUPERVISOR PP CONTACTO','Estado','Frio', 'Aire A. Frio', 'Auditor Frio','Electrico', 'Electrico Suplente', 'Electrico Suplente 3', 'GE. Propio', 'GE','Empresa energetica', 'Empresa energetica Cliente', 'Pase de Losa','SSGG Cortineria', 'SSGG Cerrajeria', 'SSGG Cerrajeria Bancaria', 'SSGG Montacargas','SSGG Fumigacion', 'SSGG Balanza', 'SSGG Bascula', 'SSGG Puertas Automaticas','SSGG Cintas Checkout', 'SSGG Zorra Electricas', 'SSGG Serial de las Zorras Electricas','SSGG Zorras Mauales', 'SSGG Decomisos/Basura', 'SSGG Limpieza', 'SSGG Frecuencia Chamical','SSGG Maquina Limp', 'SSGG Incendios', 'SSGG Sensores de Hum','SSGG SERIE1', 'SSGG SERIE2', 'SSGG SERIE3', 'SSGG SERIE4','SSGG SERIE5', 'SSGG SERIE6', 'SSGG SERIE7', 'SSGG SERIE8','Civil', 'Civil Proveedor Plan cubiertas', 'Civil Tipo Plan Cubiertas', 'Coordinador Plan Cubiertas', 'Ticket del plan Cubiertas','SHARE', 'Operaciones', 'CECO', 'CP'];
                const tienda = row['Tienda'] || 'N/A';
                const direccion = row['Direccion'] || '';
                const localidad = row['Localidad'] || '';
                const provincia = row['Provincia'] || '';
                const estado = row['Estado'] || '-';
                const gerenteVentas = row['Gerente de ventas'] || '-';
                const contactoGv = row['Gerente de ventas contacto'] || '-';
                const regional = row['Gerente Regional'] || '-';
                const contactoReg = row['Gerente regional contacto'] || '-';
                const gestion = row['Gesti√≥n'] || '-';
                const franquiciado = row['Franquiciado'] || '-';
                const contactoFranquiciado = row['Franquiciado contacto'] || '-';
                const supervisorPP = row['SUPERVISOR PP'] || '-';
                const supervisorPPContacto = row['SUPERVISOR PP CONTACTO'] || '-';
                const zona = row['Zona'] || '-';
                const formato = row['Formato'] || '-';
                const tecnicos = row['Tecnicos internos'] || '-';
                const zonaTec = row['Zona tecnicos'] || '-';
                const email = row['EMail'] || '-';
                const horarioLuSa = row['HORARIO LUNES A SABADO'] || '-';
                const horarioDo = row['HORARIO DOMINGO'] || '-';
                const sindicato = row['Sindicato'] || '-';
                const share = row['SHARE'] || '-';
                const operaciones = row['Operaciones'] || '-';
                const ceco = row['CECO'] || '-';
                const cp = row['CP'] || '-';
                
                const fullAddress = [direccion, localidad, provincia].filter(Boolean).join(', ');
                const mapsLink = `https://maps.google.com?q=${encodeURIComponent(fullAddress)}`;

                const crearLinkWhatsApp = (textoContacto) => {
                    if (!textoContacto || textoContacto === '-') return `(${textoContacto})`;
                    const numeroLimpio = String(textoContacto).replace(/\D/g, '');
                    return `(<a href="https://wa.me/${numeroLimpio}" target="_blank" class="contact-link">${textoContacto}</a>)`;
                };
                const linkContactoGv = crearLinkWhatsApp(contactoGv);
                const linkContactoReg = crearLinkWhatsApp(contactoReg);
                const linkContactoFranq = crearLinkWhatsApp(contactoFranquiciado);
                const linkSupervisorPP = crearLinkWhatsApp(supervisorPPContacto);
                
                const generarHtmlEstado = (status) => {
                    const normalizedStatus = String(status).toUpperCase().trim();
                    let colorClass = 'text-gray-500';
                    let icon = '';
                    let pulseClass = '';
                    switch (normalizedStatus) {
                        case 'ABIERTO': colorClass = 'text-green-500'; icon = 'üòä'; pulseClass = 'status-pulse'; break;
                        case 'CERRADA': colorClass = 'text-orange-500'; icon = 'üòû'; break;
                        case '#N/A': case 'CIERRE DEFINITIVO': colorClass = 'text-gray-600 dark:text-gray-400'; icon = 'üò¢'; break;
                        default: return `<strong class="font-semibold">Estado:</strong> ${status}`;
                    }
                    return `<div class="${pulseClass}"><strong class="font-semibold">Estado:</strong> <span class="${colorClass} font-bold">${icon} ${status}</span></div>`;
                };
                const estadoHtml = generarHtmlEstado(estado);

                const crearFilaDetalle = (etiqueta, valor) => {
                    if (!valor || valor === '-') return '';
                    return `<div class="md:col-span-1 text-xs font-semibold uppercase text-gray-500 dark:text-gray-400">${etiqueta}</div><div class="md:col-span-2 text-sm">${valor}</div>`;
                };
                
                const panelFrioHtml = `<details class="border-b border-gray-200 dark:border-gray-700 mb-2 overflow-hidden shadow-sm hover:shadow-lg transition-shadow rounded-lg"><summary class="p-4 font-semibold cursor-pointer flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/[.5] transition-colors"><div class="flex items-center"><span class="mr-3 text-xl">‚ùÑÔ∏è</span> Frio alimentario</div><svg class="chevron-icon h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></summary><div class="p-4 bg-gray-50 dark:bg-gray-900/50 text-sm grid grid-cols-1 md:grid-cols-3 gap-y-3 gap-x-4">${crearFilaDetalle('Frio', row['Frio'])}${crearFilaDetalle('Aire A. Frio', row['Aire A. Frio'])}${crearFilaDetalle('Auditor Frio', row['Auditor Frio'])}</div></details>`;
                const panelElectricidadHtml = `<details class="border-b border-gray-200 dark:border-gray-700 mb-2 overflow-hidden shadow-sm hover:shadow-lg transition-shadow rounded-lg"><summary class="p-4 font-semibold cursor-pointer flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/[.5] transition-colors"><div class="flex items-center"><span class="mr-3 text-xl">‚ö°Ô∏è</span> Electricidad</div> <svg class="chevron-icon h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></summary><div class="p-4 bg-gray-50 dark:bg-gray-900/50 text-sm grid grid-cols-1 md:grid-cols-3 gap-y-3 gap-x-4">${crearFilaDetalle('Empresa energetica', row['Empresa energetica'])}${crearFilaDetalle('Cliente Empresa energetica', row['Empresa energetica Cliente'])}${crearFilaDetalle('Pase de Losa', row['Pase de Losa'])}${crearFilaDetalle('Electrico', row['Electrico'])}${crearFilaDetalle('Electrico Suplente', row['Electrico Suplente'])}${crearFilaDetalle('Electrico Suplente 3', row['Electrico Suplente 3'])}${crearFilaDetalle('GE. Propio', row['GE. Propio'])}${crearFilaDetalle('GE', row['GE'])}</div></details>`;
                const panelServiciosHtml = `<details class="border-b border-gray-200 dark:border-gray-700 mb-2 overflow-hidden shadow-sm hover:shadow-lg transition-shadow rounded-lg"><summary class="p-4 font-semibold cursor-pointer flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/[.5] transition-colors"><div class="flex items-center"><span class="mr-3 text-xl">üõí</span> Servicios Generales</div><svg class="chevron-icon h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></summary><div class="p-4 bg-gray-50 dark:bg-gray-900/50 text-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-3">${Object.keys(row).filter(key => key.startsWith('SSGG') && row[key] && row[key] !== '-').map(key => `<div><p class="text-xs font-semibold uppercase text-gray-500 dark:text-gray-400">${key.replace('SSGG ', '')}</p><p>${row[key]}</p></div>`).join('')}</div></details>`;
                const panelCivilHtml = `<details class="border-b border-gray-200 dark:border-gray-700 mb-2 overflow-hidden shadow-sm hover:shadow-lg transition-shadow rounded-lg"><summary class="p-4 font-semibold cursor-pointer flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/[.5] transition-colors"><div class="flex items-center"><span class="mr-3 text-xl">üîß</span> Civil/Obras</div><svg class="chevron-icon h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></summary><div class="p-4 bg-gray-50 dark:bg-gray-900/50 text-sm grid grid-cols-1 md:grid-cols-3 gap-y-3 gap-x-4">${crearFilaDetalle('Civil', row['Civil'])}${crearFilaDetalle('Proveedor Plan cubiertas', row['Civil Proveedor Plan cubiertas'])}${crearFilaDetalle('Tipo Plan Cubiertas', row['Civil Tipo Plan Cubiertas'])}${crearFilaDetalle('Coordinador Plan Cubiertas', row['Coordinador Plan Cubiertas'])}${crearFilaDetalle('Ticket del plan Cubiertas', row['Ticket del plan Cubiertas'])}</div></details>`;
                let otrosDetallesHtml = '';
                for (const key in row) {
                    if (row[key] && !keysMostradas.includes(key)) {
                        otrosDetallesHtml += `<div class="py-1"><p class="text-xs font-semibold text-gray-500 uppercase">${key}</p><p class="text-sm text-gray-800 dark:text-gray-300">${row[key]}</p></div>`;
                    }
                }
                
                card.innerHTML = `
                    <div class="p-4 bg-gray-50 dark:bg-gray-700/[.5] border-b border-gray-200 dark:border-gray-700">
                        <div class="flex flex-wrap justify-between items-center gap-2">
                            <div>
                                <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Tienda</p>
                                <p class="text-2xl font-bold text-red-600 dark:text-red-500">${tienda}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Direcci√≥n</p>
                                <a href="${mapsLink}" target="_blank" rel="noopener noreferrer" class="text-sm font-medium hover:text-red-600 dark:hover:text-red-500 hover:underline">
                                    ${fullAddress || 'No especificada'}
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4 text-sm">
                            <div class="flex items-start"><span class="text-lg mr-2">üë§</span><div><strong class="font-semibold">Gerente Ventas:</strong> ${gerenteVentas} ${linkContactoGv}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üë§</span><div><strong class="font-semibold">Gerente Regional:</strong> ${regional} ${linkContactoReg}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üë§</span><div><strong class="font-semibold">Franquiciado:</strong> ${franquiciado} ${linkContactoFranq}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üë§</span><div><strong class="font-semibold">Supervisor PP:</strong> ${supervisorPP} ${linkSupervisorPP}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üè∑Ô∏è</span><div><strong class="font-semibold">Gesti√≥n:</strong> ${gestion}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üö¶</span>${estadoHtml}</div>
                            <div class="flex items-start"><span class="text-lg mr-2">üó∫Ô∏è</span><div><strong class="font-semibold">Zona:</strong> ${zona}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üì´</span><div><strong class="font-semibold">CP:</strong> ${cp}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üè¢</span><div><strong class="font-semibold">Formato:</strong> ${formato}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">‚öôÔ∏è</span><div><strong class="font-semibold">Operaciones:</strong> ${operaciones}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">#Ô∏è‚É£</span><div><strong class="font-semibold">CECO:</strong> ${ceco}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üîó</span><div><strong class="font-semibold">SHARE:</strong> ${share}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üõ†Ô∏è</span><div><strong class="font-semibold">T√©cnicos:</strong> ${tecnicos}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üõ†Ô∏è</span><div><strong class="font-semibold">Zona T√©c:</strong> ${zonaTec}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üìß</span><div><strong class="font-semibold">Email:</strong> ${email}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üïí</span><div><strong class="font-semibold">Horario Lun-S√°b:</strong> ${horarioLuSa}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üïí</span><div><strong class="font-semibold">Horario Dom:</strong> ${horarioDo}</div></div>
                            <div class="flex items-start"><span class="text-lg mr-2">üèõÔ∏è</span><div><strong class="font-semibold">Sindicato:</strong> ${sindicato}</div></div>
                        </div>
                    </div>
                    <div class="px-4 pb-4">
                        <details>
                            <summary class="cursor-pointer font-semibold text-red-600 dark:text-red-500 hover:text-red-800 dark:hover:text-red-400 transition-colors text-sm">
                                Ver todos los detalles...
                            </summary>
                            <div class="mt-4 pt-4 border-t dark:border-gray-700 space-y-2">
                                ${panelCivilHtml}
                                ${panelElectricidadHtml}
                                ${panelFrioHtml}
                                ${panelServiciosHtml}
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-3">
                                    ${otrosDetallesHtml}
                                </div>
                            </div>
                        </details>
                    </div>
                `;
                resultsContainer.appendChild(card);
            });
        }
    });
    </script>
</body>
</html>